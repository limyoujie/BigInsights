quit
BookXRecords = LOAD '/home/labuser20/BX-BooksCorrected.csv'
USING PigStorage(';') AS (ISBN:chararray,BookTitle:chararray,
BookAuthor:chararray,YearOfPublication:chararray,
Publisher:chararray,ImageURLS:chararray,ImageURLM:chararray,ImageURLL:chararray);
GroupByYear = GROUP BookXRecords BY YearOfPublication;
CountByYear = FOREACH GroupByYear
GENERATE CONCAT((chararray)$0,CONCAT(':',(chararray)COUNT($1)));
STORE CountByYear 
INTO '/user/work/output/pig_output_bookx' USING PigStorage('\t');
BookXRecords = LOAD '/home/labuser20/input/BX-BooksCorrected.csv'
USING PigStorage(';') AS (ISBN:chararray,BookTitle:chararray,
BookAuthor:chararray,YearOfPublication:chararray,
Publisher:chararray,ImageURLS:chararray,ImageURLM:chararray,ImageURLL:chararray);
GroupByYear = GROUP BookXRecords BY YearOfPublication;
CountByYear = FOREACH GroupByYear
GENERATE CONCAT((chararray)$0,CONCAT(':',(chararray)COUNT($1)));
INTO '/user/work/output/pig_output_bookx' USING PigStorage('\t');
BookXRecords = LOAD '/home/labuser20/input/BX-BooksCorrected.csv'
USING PigStorage(';') AS (ISBN:chararray,BookTitle:chararray,
BookAuthor:chararray,YearOfPublication:chararray,
Publisher:chararray,ImageURLS:chararray,ImageURLM:chararray,ImageURLL:chararray);
GroupByYear = GROUP BookXRecords BY YearOfPublication;
CountByYear = FOREACH GroupByYear
GENERATE CONCAT((chararray)$0,CONCAT(':',(chararray)COUNT($1)));
INTO '/user/work/output/pig_output_bookx' USING PigStorage('\t');
BookXRecords = LOAD '/home/labuser20/input/BX-BooksCorrected.txt'
USING PigStorage(';') AS (ISBN:chararray,BookTitle:chararray,
BookAuthor:chararray,YearOfPublication:chararray,
Publisher:chararray,ImageURLS:chararray,ImageURLM:chararray,ImageURLL:chararray);
GroupByYear = GROUP BookXRecords BY YearOfPublication;
CountByYear = FOREACH GroupByYear
GENERATE CONCAT((chararray)$0,CONCAT(':',(chararray)COUNT($1)));
INTO '/user/work/output/pig_output_bookx' USING PigStorage('\t');
